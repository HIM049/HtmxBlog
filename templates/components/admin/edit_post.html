{{ define "edit_post" }}

<!-- Main form for post data -->
<form id="post-form" hx-patch="/api/admin/post/{{ .Post.ID }}" hx-swap="none" hx-indicator="#save-indicator"></form>

<div class="flex h-[calc(100vh-100px)] gap-6 overflow-hidden">
    <!-- Left Column: Title and Content -->
    <div class="flex-1 flex flex-col bg-white shadow-md rounded overflow-hidden">
        <div class="p-4 border-b">
            <input form="post-form"
                class="text-2xl font-bold w-full outline-none border-b-2 border-transparent focus:border-blue-500 transition-colors py-2"
                id="title" name="title" type="text" value="{{ .Post.Title }}" placeholder="Post Title">
        </div>
        <div class="flex-1 p-4 overflow-y-auto">
            <textarea form="post-form" class="w-full h-full resize-none outline-none font-mono text-gray-700"
                id="content" name="content"
                placeholder="Type your markdown content here...">{{ .Post.Content }}</textarea>
        </div>
        <!-- Save Actions -->
        <div class="p-4 border-t bg-gray-50 flex justify-between items-center">
            <div id="save-indicator"
                class="text-sm font-semibold text-blue-600 opacity-0 transition-opacity duration-300 htmx-request:opacity-100">
                Saving changes...
            </div>
            <button form="post-form" type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded focus:outline-none focus:shadow-outline transition-colors">
                Save Changes
            </button>
        </div>
    </div>

    <!-- Right Column: Meta and Attachments -->
    <div class="w-80 flex flex-col gap-6 pr-2">

        <!-- Meta Info -->
        <div class="bg-white shadow-md rounded p-4 space-y-4">
            <h3 class="font-bold text-gray-700 border-b pb-2">Meta Info</h3>

            <div>
                <label class="block text-gray-600 text-xs font-bold mb-1" for="visibility">Visibility</label>
                <div class="relative">
                    <select form="post-form"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 text-sm leading-tight focus:outline-none focus:shadow-outline bg-white"
                        id="visibility" name="visibility">
                        <option value="public" {{ if eq .Post.Visibility "public" }}selected{{ end }}>Public</option>
                        <option value="hide" {{ if eq .Post.Visibility "hide" }}selected{{ end }}>Hide</option>
                        <option value="login" {{ if eq .Post.Visibility "login" }}selected{{ end }}>Login Required
                        </option>
                        <option value="password" {{ if eq .Post.Visibility "password" }}selected{{ end }}>Password
                            Protected</option>
                        <option value="private" {{ if eq .Post.Visibility "private" }}selected{{ end }}>Private</option>
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-gray-600 text-xs font-bold mb-1" for="category">Category</label>
                <input form="post-form"
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 text-sm leading-tight focus:outline-none focus:shadow-outline"
                    id="category" name="category" type="text" value="{{ .Post.Category.Name }}" placeholder="Category">
            </div>

            <div>
                <label class="block text-gray-600 text-xs font-bold mb-1" for="cat_color">Color</label>
                <div class="flex items-center gap-2">
                    <input form="post-form" class="shadow appearance-none border rounded h-8 w-12 p-1 cursor-pointer"
                        id="cat_color" name="cat_color" type="color" value="{{ .Post.Category.Color }}">
                    <span class="text-xs text-gray-500">Pick a color</span>
                </div>
            </div>

            <div>
                <label class="block text-gray-600 text-xs font-bold mb-1" for="tags">Tags</label>
                <input form="post-form"
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 text-sm leading-tight focus:outline-none focus:shadow-outline"
                    id="tags" name="tags" type="text" value="{{ .Post.TagsToString }}"
                    placeholder="Tags (comma separated)">
            </div>
        </div>

        <!-- Custom Vars -->
        <div class="bg-white shadow-md rounded p-4">
            <h3 class="font-bold text-gray-700 border-b pb-2 mb-2">Custom Vars</h3>
            <textarea form="post-form"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 text-xs font-mono leading-tight focus:outline-none focus:shadow-outline h-32"
                id="custom_vars" name="custom_vars" placeholder="key: value">{{ .Post.CustomVarsToString }}</textarea>
        </div>

        <!-- Attachments -->
        {{ template "attach_uploader" . }}

    </div>
</div>

{{ end }}
